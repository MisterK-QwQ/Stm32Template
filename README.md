Stm32Template 是一个基于 STM32F103C6 单片机的通用开发模板，旨在提供一套模块化、可扩展的嵌入式系统开发框架。该项目基于 STM32Cube HAL 库，结合事件驱动架构和面向对象设计，简化硬件外设操作与业务逻辑开发，适合快速搭建嵌入式应用原型。
开发环境与技术栈
硬件平台：STM32F103C6 微控制器（ARM Cortex-M3 内核）
开发工具：PlatformIO（集成编译、调试、上传功能）
框架：STM32Cube HAL（硬件抽象层，简化外设操作）
编程语言：C++17（支持现代语法特性，提升代码可读性与封装性）
调试与上传：ST-Link 调试器（支持在线调试与程序烧录）
核心架构与模块设计
1. 整体架构
项目采用「硬件抽象层 + 事件驱动 + 业务逻辑」的分层设计，各模块低耦合、高内聚，核心流程如下：
硬件初始化：通过 Manager 类统一管理外设配置与初始化
事件触发：GPIO 状态变化等硬件事件通过 Dispatcher 分发
业务处理：注册监听器响应事件，实现具体功能（如 PWM 控制、日志输出等）
2. 关键模块说明
（1）硬件抽象层（DigitalCircuit）
封装各类硬件外设为独立类，提供统一操作接口，支持快速扩展：
GPIO：通过 GPIO 类管理引脚配置（模式、上下拉、速度），支持批量初始化与状态读取，关联硬件信息（如 PWM 通道、I2C 设备等）。
通信协议：
I2CChannel：封装 I2C 读写接口，支持指定寄存器地址的数据传输。
SPIChannel：实现 SPI 发送、接收及双向传输功能。
UARTChannel：基础串口通信支持（待完善）。
外设控制：
PWMChannel：配置定时器生成 PWM 波形，支持占空比调节。
ADCChannel：提供 ADC 校准、单次转换（轮询模式）及 DMA 连续转换功能。
DMAChannel：封装 DMA 传输（含中断模式），支持数据批量搬运。
（2）事件驱动系统（Events）
基于 EmbeddedEvent::Dispatcher 实现事件分发机制，核心功能包括：
事件定义：如 GpioEvent（封装 GPIO 引脚、端口、状态等信息）。
监听器管理：支持注册 / 注销普通函数或类成员函数作为事件回调，按优先级排序执行。
事件触发：Manager 类轮询 GPIO 状态变化，自动触发对应事件并通知监听器。
（3）核心管理模块（Manager）
Manager 类作为系统核心协调者，负责：
硬件初始化：统一初始化 GPIO、定时器、UART 等外设（如配置 PA0 为 PWM 输出、PA9/PA10 为 USART1 收发引脚）。
事件调度：通过 mDispatcher 成员管理事件监听器，协调硬件事件与业务逻辑的交互。
主循环驱动：在 read() 方法中轮询硬件状态并触发事件，维持系统运行。
（4）辅助工具（Utils）
日志功能：Logger 类基于 USART1 实现日志输出，支持 DEBUG/INFO/WARN/ERROR 等级别，可通过宏 _Log 控制开关。
时间工具：Time 类提供日期时间管理（含 Unix 时间戳转换、时区调整、格式化输出等）。
系统配置：Data 结构体集中管理外设句柄（如 UART、IWDG），SystemClock_Config 配置系统时钟（基于 HSI 8MHz）。
（5）可靠性设计
看门狗（IWDG）：通过宏 _Dog 启用独立看门狗，主循环中定期「喂狗」，防止系统卡死。
模块化初始化：硬件初始化逻辑分散在各外设类中，通过 InitAll() 批量执行，降低初始化复杂度。
典型功能示例
项目默认实现了一个简单的 PWM 呼吸灯功能：
Manager 初始化 PA0 为 PWM 输出（关联 TIM2 定时器）。
注册 OnOpenLedEvent 监听器，响应 PA0 的 GPIO 事件。
事件触发时动态调整 PWM 占空比（0~100% 循环变化），并通过日志输出当前占空比。
扩展性与可维护性
配置灵活：通过 platformio.ini 可调整编译参数（如优化等级、宏定义），支持按需启用日志或看门狗。
模块解耦：硬件操作与业务逻辑通过事件机制分离，新增功能只需注册新事件监听器，无需修改底层驱动。
代码规范：遵循 C++17 标准，采用类封装与命名空间隔离，注释清晰，便于二次开发。
该模板适用于需要快速搭建 STM32 嵌入式系统的场景，尤其适合传感器数据采集、外设控制、低功耗设备等应用开发。# Stm32Template 项目描述
项目定位
Stm32Template 是一个基于 STM32F103C6 单片机的通用开发模板，旨在提供一套模块化、可扩展的嵌入式系统开发框架。该项目基于 STM32Cube HAL 库，结合事件驱动架构和面向对象设计，简化硬件外设操作与业务逻辑开发，适合快速搭建嵌入式应用原型。
开发环境与技术栈
硬件平台：STM32F103C6 微控制器（ARM Cortex-M3 内核）
开发工具：PlatformIO（集成编译、调试、上传功能）
框架：STM32Cube HAL（硬件抽象层，简化外设操作）
编程语言：C++17（支持现代语法特性，提升代码可读性与封装性）
调试与上传：ST-Link 调试器（支持在线调试与程序烧录）
核心架构与模块设计
1. 整体架构
项目采用「硬件抽象层 + 事件驱动 + 业务逻辑」的分层设计，各模块低耦合、高内聚，核心流程如下：
硬件初始化：通过 Manager 类统一管理外设配置与初始化
事件触发：GPIO 状态变化等硬件事件通过 Dispatcher 分发
业务处理：注册监听器响应事件，实现具体功能（如 PWM 控制、日志输出等）
2. 关键模块说明
（1）硬件抽象层（DigitalCircuit）
封装各类硬件外设为独立类，提供统一操作接口，支持快速扩展：
GPIO：通过 GPIO 类管理引脚配置（模式、上下拉、速度），支持批量初始化与状态读取，关联硬件信息（如 PWM 通道、I2C 设备等）。
通信协议：
I2CChannel：封装 I2C 读写接口，支持指定寄存器地址的数据传输。
SPIChannel：实现 SPI 发送、接收及双向传输功能。
UARTChannel：基础串口通信支持（待完善）。
外设控制：
PWMChannel：配置定时器生成 PWM 波形，支持占空比调节。
ADCChannel：提供 ADC 校准、单次转换（轮询模式）及 DMA 连续转换功能。
DMAChannel：封装 DMA 传输（含中断模式），支持数据批量搬运。
（2）事件驱动系统（Events）
基于 EmbeddedEvent::Dispatcher 实现事件分发机制，核心功能包括：
事件定义：如 GpioEvent（封装 GPIO 引脚、端口、状态等信息）。
监听器管理：支持注册 / 注销普通函数或类成员函数作为事件回调，按优先级排序执行。
事件触发：Manager 类轮询 GPIO 状态变化，自动触发对应事件并通知监听器。
（3）核心管理模块（Manager）
Manager 类作为系统核心协调者，负责：
硬件初始化：统一初始化 GPIO、定时器、UART 等外设（如配置 PA0 为 PWM 输出、PA9/PA10 为 USART1 收发引脚）。
事件调度：通过 mDispatcher 成员管理事件监听器，协调硬件事件与业务逻辑的交互。
主循环驱动：在 read() 方法中轮询硬件状态并触发事件，维持系统运行。
（4）辅助工具（Utils）
日志功能：Logger 类基于 USART1 实现日志输出，支持 DEBUG/INFO/WARN/ERROR 等级别，可通过宏 _Log 控制开关。
时间工具：Time 类提供日期时间管理（含 Unix 时间戳转换、时区调整、格式化输出等）。
系统配置：Data 结构体集中管理外设句柄（如 UART、IWDG），SystemClock_Config 配置系统时钟（基于 HSI 8MHz）。
（5）可靠性设计
看门狗（IWDG）：通过宏 _Dog 启用独立看门狗，主循环中定期「喂狗」，防止系统卡死。
模块化初始化：硬件初始化逻辑分散在各外设类中，通过 InitAll() 批量执行，降低初始化复杂度。
典型功能示例
项目默认实现了一个简单的 PWM 呼吸灯功能：
Manager 初始化 PA0 为 PWM 输出（关联 TIM2 定时器）。
注册 OnOpenLedEvent 监听器，响应 PA0 的 GPIO 事件。
事件触发时动态调整 PWM 占空比（0~100% 循环变化），并通过日志输出当前占空比。
扩展性与可维护性
配置灵活：通过 platformio.ini 可调整编译参数（如优化等级、宏定义），支持按需启用日志或看门狗。
模块解耦：硬件操作与业务逻辑通过事件机制分离，新增功能只需注册新事件监听器，无需修改底层驱动。
代码规范：遵循 C++17 标准，采用类封装与命名空间隔离，注释清晰，便于二次开发。
该模板适用于需要快速搭建 STM32 嵌入式系统的场景，尤其适合传感器数据采集、外设控制、低功耗设备等应用开发。
